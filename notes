AAR0nSx

1.Struktur

/kamera-steuerung
│
├── main.js       # Hauptprozess (Steuert Electron, IPC)
├── preload.js    # Sichere Kommunikation Renderer ↔ Main
├── app/          # Deine eigentliche App
│   ├── index.html
│   ├── renderer.js  # JS für die Website (Browser-Seite)
│   └── styles.css   # optionales CSS
└── package.json  # Electron und Node Konfiguration

2. Prinzip

- Index zeigt Buttons und Steuerflächen
- renderer fängt klicks ab und sendet Nachrichten an main.js (vielleicht auch eher alles in einer Datei)
- main.js führt Befehle an der Kamera aus (mit HTTP needle)

Um auf Event zu reagieren z.B.:

// renderer.js
ipcRenderer.send('move-camera', { direction: 'left' });

// main.js
ipcMain.on('move-camera', (event, data) => {
  console.log('Kamera bewegen:', data.direction);
  // Hier dann Request an Kamera senden
});

3. Frontend index und renderer.js (bzw. main.js wenn ichs zusammenlege)

- einfaches UI (Buttons für links, rechts etc.)
- Dropdown für Belichtung?
- Slider für zoom oder stufenweise irwie idk
=> onEvent(Button gedrückt) -> Kamera bewegt sich

4. Backend main.js

- empfängt steuerbefehle (vom renderer?)
- sendet HTTP request am Kamera (über needle oder fetch)
- Fehlerbehandlung:
    - Kamera nicht erreichbar (Netzwerkfehler, falsche IP)
    - Kamera gibt Fehlercode zurück (404, 500)
    - Timeout
    =>prüfen ob Error oder Statuscode nicht 200 sind

    needle.get('http://kamera-ip/befehl', (error, response) => {
      if (error) {
        console.error('Netzwerkfehler:', error.message);
        return;
      }
      if (response.statusCode !== 200) {
        console.error('Kamera Fehler:', response.statusCode);
        return;
      }
      console.log('Erfolgreich:', response.body);
    });


    - Bei Error erneut versuchen?
    - Fehlermeldung im Frontend ausgeben

    IPC Fehler:
    - Kanalname falsch
    - falsche/fehlende Parameter

    ipcMain.on('move-camera', (event, data) => {
      if (!data || !data.direction) {
        console.error('Ungültige Kamerasteuerung:', data);
        return;
      }
      console.log('Bewege Kamera Richtung:', data.direction);
    });


    BrowserWindow Fehler:
    - index nicht gefunden

    mainWindow.loadFile('index.html').catch(err => {
      console.error('Fehler beim Laden von index.html:', err);
    });


Stabilität:
    - Buttons deaktivieren, während anfrage läuft
    - automatisch neuen Versuch nach 1-2 Sekunden




    ------------------------------------------------------------


 TODO

JS writing an dreading files:

 https://nodejs.org/en/learn/manipulating-files/writing-files-with-nodejs

 https://www.w3schools.com/xml/xml_parser.asp

 https://www.mediaevent.de/javascript/xml-mit-fetch.html




WB

OnepushWb ist wbmodeidx = 3
Bei druck auf One push trigger Knopf
{"wbmodeidx":"","crgain":"","cbgain":"","wbonepushtrigger":"[object Event]"}

Manual red und Manual Blue sind nur im manual mode verfügbar
manual ist wbmodeidx = 5
Slider gehen von 0 bis 128 (beide)


Tabs für Settingspage?
https://www.w3schools.com/howto/howto_js_tabs.asp

oder hier vlt
https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page



----------------
// Speichern nach Fokusbewegung:
localStorage.setItem("lastFocusMode", value); // "0" oder "1"
localStorage.setItem("lastFocusValue", value); // z. B. 1234

// Beim Start:
const savedMode = localStorage.getItem("lastFocusMode");
const savedFocus = localStorage.getItem("lastFocusValue");

if (savedMode !== null) window.electronAPI.setFocus("focusautoidx", savedMode);
if (savedFocus !== null) window.electronAPI.setFocus("focuspositon", savedFocus);




In JavaScript, localStorage ist ein Speicher, in dem Daten im Browser des Benutzers gespeichert werden können, ohne
 dass sie beim Schließen des Browsers gelöscht werden. setItem() speichert Daten mit einem Schlüssel und Wert,
 während getItem() gespeicherte Daten anhand des Schlüssels abruft.

setItem():
Syntax: localStorage.setItem(key, value);
Funktion: Speichert einen Wert (das Argument value) unter einem bestimmten Schlüssel (das Argument key) im localStorage.
Wenn ein Schlüssel bereits existiert, wird der Wert aktualisiert.
Beispiel: localStorage.setItem("username", "MaxMustermann"); speichert den Wert "MaxMustermann" unter dem
Schlüssel "username".

getItem():
Syntax: localStorage.getItem(key);
Funktion: Ruft den Wert aus dem localStorage ab, der mit dem angegebenen Schlüssel (das Argument key) verknüpft ist.
Beispiel: let username = localStorage.getItem("username"); speichert den Wert, der unter dem Schlüssel
"username" gespeichert ist, in der Variable username.

Zusätzliche Informationen:
Datenspeicherung: localStorage speichert Daten als Key-Value-Paare (Schlüssel-Wert).
Datentyp: Sowohl Schlüssel als auch Werte sind Strings.
Domain: Die Daten im localStorage sind domain-spezifisch, d.h. Daten, die auf einer Seite gespeichert werden,
sind nur für diese Seite und Unterseiten der gleichen Domain zugänglich.
Löschen: removeItem() entfernt ein Element aus dem localStorage. clear() löscht alle Daten aus dem localStorage.
Session Storage: Es gibt auch sessionStorage, das Daten nur während der Sitzung des Benutzers
(d.h. bis der Browser geschlossen wird) speichert.




Daten die geladen/gespeichert werden müssen:
ids der DOM Elemente:

zoom-level
zoom-slider

focus-mode
focus-range

wb-mode
wb-manual-red
wb-manual-blue

picture-brightness
picture-saturation
picture-sharpness

exposure-mode
shutter
gain
gamma



in den presets wird nicht alles gesetzt, zum Beispiel exposure mode ist immer auf full auto bei jedem preset,
auch wenn man es bei der preset Aufnahme geändert hat


-> Preset Buttons (weiße Zahl in der mitte) und den Screenshot vom preset in den Button reinladen
Man sieht sofort welche schon belegt sind und mit was



--> Button richtig umrahmen lassen!
--> Andere templates laden, je nachdem wie viele textfelder (IPs) vergeben sind und damit die dynamische
Darstellung faken!!

--> Roter und grüner Punkt oder so für Verbindungsstatus (regelmäßig abfragen? EventListener? vlt onChange oder sowas)

--> IP Adressfelder Eingabesicher machen

--> Fehlerbehandlungen einbauen:
- Netzwerkkabel gezogen